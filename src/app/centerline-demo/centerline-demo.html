<div class="demo-container">
	<h3>Centerline Follower Demo</h3>
	<p class="instructions">
		<strong>What to expect:</strong> A <span class="vehicle-indicator">blue circle</span> represents your vehicle.
		It starts at the beginning of the red centerline. Use steering controls or arrow keys to move it.
		<br>
		<strong>Red line:</strong> Racing centerline • <strong>Cyan zones:</strong> Jumps/wallrides
	</p>

	<!-- Canvas for topdown visualization -->
	<canvas
		#demoCanvas
		class="demo-canvas"
		[width]="canvasWidth()"
		[height]="canvasHeight()">
	</canvas>

	<!-- Gauges -->
	<div class="gauges">
		<div class="gauge">
			<label>Arc-length s (m):</label>
			<span>{{ vehicleState().s.toFixed(2) }}</span>
		</div>
		<div class="gauge">
			<label>Lateral d (m):</label>
			<span>{{ vehicleState().d.toFixed(3) }}</span>
		</div>
		<div class="gauge">
			<label>Heading ψ (rad):</label>
			<span>{{ vehicleState().psi.toFixed(3) }}</span>
		</div>
		<div class="gauge">
			<label>Speed v (m/s):</label>
			<span>{{ vehicleState().v.toFixed(2) }}</span>
		</div>
		<div class="gauge">
			<label>Steering δ (rad):</label>
			<span>{{ steeringAngle().toFixed(3) }}</span>
		</div>
	</div>

	<!-- Controls -->
	<div class="controls">
		<button (click)="toggleSimulation()">
			{{ isRunning() ? 'Pause' : 'Resume' }}
		</button>
		<button (click)="resetVehicle()">Reset</button>
		<div>
			<label>Steering (← | →):</label>
			<input
				type="range"
				min="-0.5"
				max="0.5"
				step="0.01"
				[value]="steeringAngle()"
				(change)="steeringAngle.set(+$any($event.target).value)" />
		</div>
		<div>
			<label>Speed:</label>
			<input
				type="range"
				min="0"
				max="5"
				step="0.1"
				[value]="speed()"
				(change)="speed.set(+$any($event.target).value)" />
		</div>
	</div>

	<p class="info" *ngIf="!centerlineParams()">
		Centerline not parameterized. Annotate and export a track first.
	</p>
</div>
